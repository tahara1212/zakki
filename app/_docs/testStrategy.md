---
title: "テスト戦略を考える"
category: "テスト"
---

# テスト戦略を考える
ウェブアプリケーションが複雑化した近年では、動的なコンテンツやインタラクティブな機能を持つウェブアプリが増加し、フロントエンド領域においてもテストが重要視されるようになりました。  

私が現在のプロダクトに参画した時、アプリケーションの基盤構築は既に前任の方々によって実装済みでした。
そして、私の参画と同時に前任の方々は全て離任し、引き継ぎ期間も全くありませんでした。


漠然と「テストを導入すべきである」という圧を感じるようにはなったものの、具体的なテスト戦略について考えるのはとても難しいです。  
テストは品質を担保するための義務ではなく、目的を達成するための手段であり、その目的や優先度はプロダクトによって異なります。  
そのため、ただやればいい、というものではありません。  

他のプロダクトのテスト戦略をそのまま模倣しても、自分たちのプロダクトにとってその戦略が効果的とは限りません。  
何を達成したいかによって、戦略は多様に変化するので、テスト戦略に関する明確な答えを一概に見つけることは難しく、自分たちに合った戦略を考える必要があります。

## この記事で書きたいこと
- なぜテストをするのか
- テストの種類と分類
- どのようにテスト戦略を考えるのか
- 自分が考えたテスト戦略

## なぜテストをするのか
テストの目的は、プロダクトの指針やゴールに依存しているべきです。  
例えば、ユーザーエクスペリエンスを重視するプロダクトでは、機能テストやUIテストが重要視されますが、金融システムなどでは、セキュリティやデータ整合性のテストが優先されます。プロダクトの特性や市場のニーズを考慮して、テストの目的を明確にする必要があります。  

早期に収益化を目指すアプリケーションなどにおいては、デリバリーが最優先であるため、テストが煩わしく感じることもあります。  
テストは、短期的な観点では開発効率を妨げる印象を与えます。テストを書くというだけで余計な工数が発生し、それ自体の恩恵も実装時には実感しづらいため、「テストを書く暇があれば開発を進めれば良いのでは？」という考えが生まれるのです。  

新機能のリリースを急ぐ際にテストを省略すると、開発の効率が向上するかもしれません。しかし、中長期的には、機能追加や仕様変更が積み重なることでシステムが複雑化し、保守が難しくなります。結果として、テストがないことで既存機能に不具合が生じ、長期的なデリバリーの遅延を招くことになります。持続的な開発サイクルを実現するためには、テストは非常に重要です。  

ただし、目的や意図の無いテストを乱立することも効果的とは言えません。これは余計なコストが発生するだけでなく、テスト自体が技術的な負債として残ることもあります。  
例えば、意図もなくカバレッジ率を重視して過剰にテストを書きすぎると、本来の目的を見失っていきます。  
テストカバレッジは、テストの範囲を測るための有用な指標ですが、それ自体が目的になってはいけません。カバレッジ率が80%であっても、重要なビジネスロジックがテストされていなければ、目的は達成できていません。適切なカバレッジを設定するためには、プロダクトにおけるリスクの高い部分や重要な機能に重点を置いたテスト計画を立てることが必要です。カバレッジはあくまで一つの目安として活用し、実際のテストの目的と整合させることが重要です。  

プロダクト固有の目的や意図に沿ってテストを設計していくことがテスト戦略になります。

## テストの種類を知る
テスト戦略を考えるためには、選択肢について知る必要があります。これを理解していない状態では、何から考えて良いのかすら判断できません。  
これについては明確な答えが用意されている分、テスト戦略を考えることよりも頭を悩ませる心配はなさそうです。

### テストの分類と範囲
- 静的解析
    
    コードが実行される前に、コードの品質やスタイル、潜在的なエラーを検出します。
    TypeScript、ESLint、Prettier などのツールがあります。  
    コードの一貫性を保ち、バグを未然に防ぐことを目的とします。
    
- 単体テスト
    
    個々の関数やコンポーネントが正しく動作するかを確認します。  
    Jest、Mocha、Jasmine などが利用されています。  
    リファクタリングや変更を行った際に、各機能が仕様通りに動作することを保証し、安全性を高めます。
    
- 結合テスト
    
    複数のモジュールを組み合わせて、相互作用やデータの流れが正しく機能するかを確認します。  
    Cypress、Testing Library などが利用されています。  
    モジュール間の統合が正しく行われているかを検証し、全体のビジネスロジックが期待通りであるかを確認します。
    
- E2Eテスト（End to Endテスト）
    
    実際のユーザー操作をシミュレートして、最も広範囲な結合テストを行います。  
    Cypress、Selenium、Playwright などのツールがあります。  
    ユーザーがアプリケーションを使用する際のシナリオを再現し、すべてのコンポーネントが連携して正しく機能しているかを確認します。


### 目的によって実施するテスト

- パフォーマンステスト
    
    アプリケーションの応答性や安定性、スケーラビリティを測定するテストです。  
    Lighthouse、WebPageTest、JMeter などのツールがあります。  
    アプリケーションが高負荷の状況でも適切に動作するかを検証し、ユーザー体験を最適化することを目指します。

- アクセシビリティテスト
    
    アプリケーションが多様なユーザーにとって利用可能であるのかを検証するテストです。  
    axe、WAVE などのツールがあります。  
    ユーザーインターフェースがすべての人にとってアクセス可能であることを確認し、標準やガイドラインに準拠していることを目指します。

これらのテストを全て実施することは理想的ではありますが、現実的にはリソースに限りがあります。  
このような場合は、プロジェクトの特性やビジネス要件、チームの規模、技術スタックなどを考慮し、テストの優先順位をつけることが重要になります。  

テストの分類とそれぞれの目的を理解したら、これらをプロダクトにどう嵌め込んでいくのかイメージがついてくると思います。

## どのようにテスト戦略を考えるのか
テストの分類を理解した後に戦略を0から組み立てる必要はなく、テスト戦略についても既にいくつかのモデルがあります。これらをベースにして、テスト戦略を考えていくこともできます。  

### テスト戦略モデル
#### テストピラミッド型

![テストピラミッド型](/images/Pyramid.png)
![アイスクリームコーン型](/images/IceCreamCone.png)
![テスティングトロフィー型](/images/Trophy.png)
![バルーン型](/images/Balloon.png)


## 自分が考えたテスト戦略