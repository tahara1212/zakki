---
title: "microCMS 検索機能について"
category: "インフラ・サーバーサイド関連"
---

# microCMS 検索機能について
microCMS の API で記事検索を実施する方法について。  
API で検索結果を取得するため、静的HTMLのサイト内検索などは `Pagefind` などの外部ツールを使う方が良い。

### 検索負荷
当然だが、対象フィールドが増えるほど負荷は高まる。特に記事本文は全ての文字列を見に行くので、かなり重い。  
API リクエストの上限は29秒なので、それ以上処理に時間がかかるとタイムアウトする。  

#### q
`q`パラメータを使用した検索は、全文検索でも負荷を抑えることができる。  
microCMS の仕様で、登録データを形態素解析して検索を実施する。microCMS に依存するので、ロジックは見えない&アプデで変わる可能性もある。ただし、全文検索にしてはそれなりに高速。不自然な単語の区切りには対応できないものの、自然な言葉の単位では検索ができる。  
`orders`の指定がなければ、microCMS 独自の「関連性」に準拠してソートされる。  
複数文言検索を行う場合、検索文言単位でリクエストを送る必要がある。

#### filters
部分一致を完璧に行う場合は、`filters`を使用するしかない。ただし、かなり遅い。  
複数文言検索の場合は以下のようになる。
e.g. `body[contains]${query}[or]body[contains]${query}`

